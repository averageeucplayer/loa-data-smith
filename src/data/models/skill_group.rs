use crate::deserializer::*;
use chrono::Duration;
use once_cell::sync::Lazy;
use rustc_hash::FxHashSet;
use serde::{Deserialize, Deserializer, Serialize};
use strum::IntoEnumIterator;
use strum_macros::EnumIter;
use crate::deserializer::*;

#[derive(Debug, PartialEq, Eq, Hash, Clone, EnumIter)]
#[repr(u32)]
pub enum SkillGroup {
    None,
    BreakerSkillAsuraDestructionBasicAttack = 36000,
    StrikerSkillAdvancingStrike = 39370,
    PaladinSkillExecutionOfJudgment = 2365600,
    PaladinSkillExecutionOfJudgment1 = 2365700,
    PaladinHolySkills = 140001,
    PaladinJudgmentSkills = 2360090,
    ArtistSkillPaintIllusionDoor = 610001,
    AllClassHandOrWeaponAttackSkills = 991000,
    WarriorMaleSkills = 400000010,
    BardSkills = 220000,
    BardAwakeningSkills = 220003,
    BardHyperAwakeningSkills = 2215000,
    ArtistSkills = 610000,
    ArtistAwakeningSkills = 610002,
    ArtistIdentitySkills = 610003,
    AllReaperSkills = 2260901,
    ReaperSkills = 2260000,
    ReaperSkills1 = 430000,
    ReaperSkills2 = 2260401,
    ReaperSkills3 = 2260900,
    SouleaterAwakeningSkills1 = 2465000,
    SouleaterAwakeningSkills2 = 2465300,
    SouleaterAwakeningSkills3 = 440004,
    SouleaterHyperAwakeningSkills = 2465500,
    SouleaterSkills1 = 2460500,
    SouleaterSkills2 = 440001,
    SouleaterSkills3 = 2460901,
    SouleaterSkills4 = 2460400,
    SouleaterSkills5 = 440002,
    SouleaterSkills6 = 440003,
    WardancerAwakeningSkills = 2225000,
    WardancerEsotericSkills = 2221101,
    WardancerEsotericSkills1 = 2221100,
    WardancerEsotericSkills2 = 2220400,
    WardancerSkills = 310000,
    WardancerSkills1 = 2220900,
    DeadeyeSkills = 520000,
    DeadeyeSkills1 = 2293400,
    GlaivierSkills = 2340900,
    GlaivierSkills1 = 340001,
    ArcanistSkills = 2192001,
    SoulfistSkills1 = 2240900,
    SoulfistSkills2 = 2240800,
    SoulfistSkills3 = 330000,
    AllSlayerAwakeningSkills = 2455200,
    SlayerSkills1 = 2455000,
    SlayerSkills2 = 150000,
    SlayerSkills3 = 150004,
    ShadowhunterAwakeningSkills = 2275000,
    ShadowhunterSkills = 2270400,
    ShadowhunterSkills1 = 420004,
    ScrapperAwakeningSkills = 2235000,
    GunlancerSkills = 2170110,
    GunlancerSkills1 = 2170070,
    GunlancerSkills2 = 130000,
    GunlancerBlueSkills = 2170100,
    GunlancerAwakeningSkills = 2175200,
    DestroyerHyperAwakeningSkills = 120003,
    DestroyerAllAwakeningSkills = 2185000,
    AeromancerSkills = 630102,
    AeromancerSkills1 = 2320900,
    AeromancerSkills2 = 2320401,
    DeadeyeAwakeningSkills = 2295200,
    AllClassSkills = 16000000,
    AllClassSkills1 = 200,
    AllClassSkills2 = 36,
    AllClassSkills3 = 14000000,
    AllClassSkills4 = 10000002,
    AllClassSkills5 = 12000002,
    AllClassSkills6 = 14000001,
    AllClassSkills7 = 28,
    AllClassSkills8 = 15000000,
    AllClassSkills9 = 27,
    AllClassSkills10 = 17000000,
    AllClassSkills11 = 100,
    AllClassSkills12 = 10000001,
    AllClassSkills13 = 33,
    StrikerWardancerSouleaterSkills = 202,
    SoulfistMachinistScrapperBreakerSkills = 201,
    AllClassAwakeningSkills = 991021,
    AllClassAwakeningSkills1 = 10000000,
    AllClassAwakeningSkills2 = 30,
    AllClassAwakeningSkills3 = 11000002,
    AllClassAwakeningSkills4 = 9900,
    AllClassAwakeningSkills5 = 11000000,
    AllClassAwakeningSkills6 = 991011,
    AllClassAwakeningSkills7 = 991001,
    Class21Skills = 13000002,
    BerserkerHyperAwakeningSkills = 2165100,
    BerserkerAllAwakeningSkills = 2165200,
    BerserkerAwakeningSkills = 110003,
    GunslingerSkills = 2512030,
    SummonerAwakeningSkills = 2205000,
    SummonerSkills = 23001,
    SummonerSkills1 = 23000,
    SummonerSkills2 = 2200900,
    SummonerSkills3 = 199,
    SummonerSkills4 = 230000,
    SummonerSkills5 = 2200800,
    SummonerSkills6 = 32,
    AllGunslingerSkills = 2512010,
    GunslingerSkills1 = 2294200,
    GunslingerSkills2 = 550000,
    StrikerSkills1 = 310001,
    StrikerSkills2 = 2391005,
    StrikerSkills3 = 2390801,
    StrikerSkills4 = 2390900,
    StrikerSkills5 = 2391001,
    StrikerSkills6 = 350000,
    StrikerSkills7 = 2390800,
    StrikerSkills8 = 2390901,
    BreakerAwakeningSkills = 2475000,
    BreakerHyperAwakeningSkills = 360002,
    BreakerSkills1 = 47000,
    BreakerSkills2 = 360001,
    BreakerSkills3 = 2470500,
    BreakerSkills4 = 2470510,
    BreakerSkills5 = 47001,
    BreakerSkills6 = 360000,
    BreakerIdentitySkills1 = 630104,
    BreakerIdentitySkills2 = 360003,
    DeathbladeSkills = 2251000,
    DeathbladeSkills1 = 410000,
    DeathbladeSkills2 = 2250900,
    DeathbladeAwakeningSkills = 2255000,
    MachinistAwakeningSkills = 2355000,
    MachinistSkills = 54001,
    MachinistSkills1 = 35090,
    MachinistSkills2 = 2350600,
    MachinistSkills3 = 540004,
    MachinistSkills4 = 540001,
    MachinistSkills5 = 540101,
    MachinistSkills6 = 2350800,
    MachinistSkills7 = 54000,
    ArtilleristSkills1 = 14000002,
    ArtilleristSkills2 = 530004,
    ArtilleristSkills3 = 530000,
    ArcanistAwakeningSkills = 2195000,
    SharpshooterAwakeningSkills = 510003,
    SharpshooterSkills1 = 510000,
    SharpshooterSkills2 = 510005,
    AllClassSpaceBarSkills = 991100,
    AllClassSpaceBarSkills1 = 991101,
    AllClassStandUpSkills1 = 1410005,
    AllClassStandUpSkills2 = 991200,
    SupportIdentityAndHyperAwakeningTechniqueSkills = 16000001,
    Unknown3 = 11000,
    Unknown4 = 11001,
    Unknown5 = 550001,
    Unknown6 = 150003,
    Unknown7 = 2455100,
    Unknown8 = 440000,
    Unknown9 = 2465400,
    Unknown10 = 2391002,
    Unknown11 = 2512040,
    Unknown12 = 2375000,
    Unknown13 = 240000,
    Unknown14 = 2365000,
    Unknown15 = 140002,
    Unknown16 = 2350500,
    Unknown17 = 2351100,
    Unknown18 = 2341000,
    Unknown19 = 2321100,
    Unknown20 = 2385000,
    Unknown21 = 550002,
    Unknown22 = 29073,
    Unknown23 = 29072,
    Unknown24 = 2391000,
    Unknown25 = 350001,
    Unknown26 = 350003,
    Unknown27 = 2395000,
    Unknown28 = 120001,
    Unknown29 = 120002,
    Unknown30 = 2180090,
    Unknown31 = 2190400,
    Unknown32 = 14000003,
    Unknown33 = 2190901,
    Unknown34 = 2170040,
    Unknown35 = 2170050,
    Unknown36 = 130001,
    Unknown37 = 34,
    Unknown38 = 2170090,
    Unknown39 = 14000,
    Unknown40 = 14001,
    Unknown41 = 29,
    Unknown42 = 2200700,
    Unknown43 = 230004,
    Unknown44 = 230014,
    Unknown45 = 110004,
    Unknown46 = 110000,
    Unknown47 = 2160080,
    Unknown48 = 2165000,
    Unknown49 = 2170080,
    Unknown50 = 230012,
    Unknown51 = 13000,
    Unknown52 = 13001,
    Unknown53 = 430001,
    Unknown54 = 203,
    Unknown55 = 430004,
    Unknown56 = 2260200,
    Unknown57 = 2295300,
    Unknown58 = 53000,
    Unknown59 = 2301000,
    Unknown60 = 530005,
    Unknown61 = 60000,
    Unknown62 = 2300400,
    Unknown63 = 31,
    Unknown64 = 2320901,
    Unknown65 = 2391003,
    Unknown66 = 2391004,
    Unknown67 = 2385100,
    Unknown68 = 240001,
    Unknown69 = 2360040,
    Unknown70 = 550003,
    Unknown71 = 2385200,
    Unknown72 = 2512000,
    Unknown73 = 2370400,
    Unknown74 = 2192000,
    Unknown75 = 2200910,
    Unknown76 = 230005,
    Unknown77 = 2370900,
    Unknown78 = 210001,
    Unknown79 = 2190402,
    Unknown80 = 540000,
    Unknown81 = 2350701,
    Unknown82 = 210000,
    Unknown83 = 2190401,
    Unknown84 = 2271000,
    Unknown85 = 420001,
    Unknown86 = 42000,
    Unknown87 = 2275300,
    Unknown88 = 2275400,
    Unknown89 = 2284400,
    Unknown90 = 2283400,
    Unknown91 = 2285000,
    Unknown92 = 2285010,
    Unknown93 = 520001,
    Unknown94 = 520002,
    Unknown95 = 530003,
    Unknown96 = 530006,
    Unknown97 = 53001,
    Unknown98 = 2305000,
    Unknown99 = 620000,
    Unknown100 = 630101,
    Unknown101 = 2340100,
    Unknown102 = 2340101,
    Unknown103 = 340002,
    Unknown104 = 2345000,
    Unknown105 = 2353400,
    Unknown106 = 2350700,
    Unknown107 = 240002,
    Unknown108 = 2512020,
    Unknown109 = 240003,
    Unknown110 = 240004,
    Unknown111 = 2360080,
    Unknown112 = 2365200,
    Unknown113 = 2365100,
    Unknown114 = 2355200,
    Unknown115 = 2351101,
    Unknown116 = 540002,
    Unknown117 = 540003,
    Unknown118 = 140003,
    Unknown119 = 62000,
    Unknown120 = 2320400,
    Unknown121 = 2321101,
    Unknown122 = 1100000,
    Unknown123 = 2170081,
    Unknown124 = 2175000,
    Unknown125 = 2251101,
    Unknown126 = 2250200,
    Unknown127 = 1410004,
    Unknown128 = 41000,
    Unknown129 = 41001,
    Unknown130 = 2251100,
    Unknown131 = 210003,
    Unknown132 = 2190902,
    Unknown133 = 210002,
    Unknown134 = 29071,
    Unknown135 = 220004,
    Unknown136 = 2210200,
    Unknown137 = 320002,
    Unknown138 = 320003,
    Unknown139 = 320004,
    Unknown140 = 2250500,
    Unknown141 = 2255700,
    Unknown142 = 2260400,
    Unknown143 = 300,
    Unknown144 = 2270901,
    Unknown145 = 2270600,
    Unknown146 = 2270900,
    Unknown147 = 42001,
    Unknown148 = 51000,
    Unknown149 = 51001,
    Unknown150 = 2284100,
    Unknown151 = 2285200,
    Unknown152 = 2305100,
    Unknown153 = 2315000,
    Unknown154 = 130003,
    Unknown155 = 2175100,
    Unknown156 = 2170071,
    Unknown157 = 77390000,
    Unknown158 = 120004,
    Unknown159 = 2160060,
    Unknown160 = 2185200,
    Unknown161 = 230011,
    Unknown162 = 230013,
    Unknown163 = 2201100,
    Unknown164 = 320001,
    Unknown165 = 220001,
    Unknown166 = 310003,
    Unknown167 = 2245000,
    Unknown168 = 2241000,
    Unknown169 = 410004,
    Unknown170 = 2271100,
    Unknown171 = 2265400,
    Unknown172 = 430003,
    Unknown173 = 430002,
    Unknown174 = 2255400,
    Unknown175 = 620002,
    Unknown176 = 2255300,
    Unknown177 = 2292200,
    Unknown178 = 2285100,
    Unknown179 = 2270500,
    Unknown180 = 510004,
    Unknown181 = 420000,
    Unknown182 = 410003,
    Unknown183 = 2250400,
    Unknown184 = 630103,
    Unknown185 = 2260500,
    Unknown186 = 211808,
    Unknown187 = 2305200,
    Unknown188 = 2325500,
    Unknown189 = 2355100,
    Unknown190 = 340003,
    Unknown191 = 2255500,
    Unknown192 = 520003,
    Unknown193 = 2185100,
    Unknown194 = 2190900,
    Unknown195 = 230006,
    Unknown196 = 230003,
    Unknown197 = 24000,
    Unknown198 = 29070,
    Unknown199 = 2320700,
    Unknown200 = 2295000,
    Unknown201 = 2325300,
    Unknown202 = 2265000,
    SoulfistAwakeningSkills = 330003,
    ReaperHyperAwakeningTechniqueSkills = 2265500,
    ReaperHyperAwakeningTechniqueSkills1 = 2265300,
    ShadowhunterAwakeningSkills1 = 420003,
    ShadowhunterHyperAwakeningTechniqueSkills = 2275500,
    DeadeyeAwakeningSkills1 = 2295100,
    AeromancerAwakeningSkills1 = 620001,
    AeromancerHyperAwakeningSkills = 2325400,
    AeromancerAwakeningSkills = 2325000,
    ReaperFatalStepSkill = 430005
}

pub static SKILL_GROUPS: Lazy<FxHashSet<u32>> = Lazy::new(|| {
    // SkillGroup::iter().collect()
    SkillGroup::iter().map(|sg| sg as u32).collect()
});

impl<'de> Deserialize<'de> for SkillGroup {
    fn deserialize<D>(deserializer: D) -> Result<Self, D::Error>
    where
        D: Deserializer<'de>,
    {
        let value = u32::deserialize(deserializer)?;

        if SKILL_GROUPS.contains(&value) {
            return unsafe {
                Ok(std::mem::transmute(value))
            }    
        }

        Ok(SkillGroup::None)
    }
}
